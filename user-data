#cloud-config
autoinstall:
  identity:
    hostname: jammy-server-raid
    password: $6$lKcva4t.TP.1cnZt$B.ZsuZJ2.xr1riFvkzFmIL01B9GsaG2cEC0RRYfAUxLm9xPP14WuU/M552buzQrnSFUwWQdz4PQDlmVk33lBy1
    realname: Ubuntu user
    username: ubuntu
  keyboard:
    layout: us
  locale: en_US.UTF-8
  ssh:
    allow-pw: false
    install-server: true
  storage:
    config:
    - type: disk
      id: disk-0
      ptable: gpt
      path: /dev/vda
      wipe: superblock
      grub_device: true
    - type: disk
      id: disk-1
      path: /dev/vdb
      wipe: superblock
    - id: raid-0
      type: raid
      name: md0
      raidlevel: 1
      devices: [disk-2, disk-1]
      ptable: gpt
      grub_device: true
    - type: partition
      id: part-1
      device: raid-0
      size: 512M
      flag: bios_grub
    - type: partition
      id: part-2
      device: raid-0
      size: 8G
    - type: format
      id: fs-0
      fstype: fat32
      volume: part-1
    - type: format
      id: fs-1
      fstype: ext4
      volume: part-2
    - type: mount
      id: mount-0
      device: fs-0
      path: /boot/efi
    - type: mount
      id: mount-1
      device: fs-1
      path: /
    version: 1
  late-commands:
  - 'echo "ubuntu ALL=(ALL) NOPASSWD:ALL" > /target/etc/sudoers.d/ubuntu'
  - chmod 440 /target/etc/sudoers.d/ubuntu
  version: 1
